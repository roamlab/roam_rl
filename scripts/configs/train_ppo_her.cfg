[experiment]
experiment_no = 0
robot_name = newtonian_type1_snake_numpy_simulated
logging = logging
ppo = my_ppo

[my_ppo]
env_maker = my_env_maker
vec_env_maker = my_vec_env_maker
network = mlp
total_timesteps = 4.096e3
lr = lambda f: 3.0e-4 *f
nsteps = 1024
log_interval = 1
value_network = copy
nminibatches = 32
noptepochs = 10
num_hidden = 64
num_layers = 2
hs_strategy = split10
seed = 0

[my_vec_env_maker]
type = subproc
nenvs = 2
normalize = True

[my_env_maker]
type = wrap_obs_env_maker
robot_env = my_robot_env
observation_wrapper = DictInputWrapper
observation_keys = ['observation', 'achieved_goal', 'desired_goal']

[my_robot_env]
type = robot_goal_env
robot_world = my_robot_world
state_sampler = my_state_sampler
reward_func = my_reward_func
observation_func = my_observation_func
goal_sampler = my_goal_sampler
render_gui = render_gui
max_episode_steps = 100
nenvs = 2
vectorize_type = subproc
normalize = True

[my_robot_world]
type = simulated_robot_world
steps_per_action = 10
data_type = numpy
dynamics = my_dynamics
sensor_model = my_sensor_model

[my_state_sampler]
type = snake_uniform_state_sampler
kinematics = my_dynamics
p0_range = [0, 0]
v0_range = [0, 0]
q_range = [-1, 1]
qd_range = [0, 0]

[my_reward_func]
type = dense_goal_based_reward
achieved_goal_reward = smooth_abs
alpha = 1.0
action_reward = quadratic
beta = 0.1

[my_observation_func]
type = snake_goal_env_observation_func

[my_goal_sampler]
type = annular_goal_sampler
radius_range = [0.3, 0.50]
center = [0, 0]

[my_sensor_model]
type = snake_sensor_model
kinematics = my_dynamics
attributes = ['p0', 'q', 'v0', 'qd']

[my_dynamics]
type = newtonian_type1_snake_numpy_simulated
num_links = 3
link_length = 0.2
link_mass = 0.2
torques_max = 0.5
gravity_y = 0.0
gravity_z = 0.0
friction = my_friction
delta_t = 0.001
solver_type = euler
wrap_angles = True
joint_limits = False

[my_friction]
apply_viscous_joint_friction = True
mu_viscous_joint = 0.01
apply_dry_friction = False
mu_dry_forward = 0.1
mu_dry_sideways = .9
apply_viscous_friction = False
mu_viscous_forward = 1.0
mu_viscous_sideways = 10.0

[render_gui]
type = newtonian_arm_numpy_simulated
record_sim = False
record_fps = 100
render_rate = .01
time_frame = robot
is_live = True
lim_x = [-3,3]
lim_y = [-3,3]

[logging]
enable_detail_logging = False
env_base_log_level = 12
env_detail_log_level = 11
script_base_level = 12
script_detail_level = 11
script_debug_level = 10
script_console_level = 12
